<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>【工业与大数据】大数据基础 | Gridea</title>
<link rel="shortcut icon" href="https://dupl.github.io/gridea/favicon.ico?v=1744703986223">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://dupl.github.io/gridea/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="【工业与大数据】大数据基础 | Gridea - Atom Feed" href="https://dupl.github.io/gridea/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="大数据这个词已经火热了很多年，似乎处处都存在着大数据的噱头，让我们回归本质，探讨一下大数据是什么？
本文介绍了大数据技术细节以及相关背景的的一些概念。本文并未对大数据的相关知识进行总结，所以本文仅作为参考，无需详细阅读。

背景 为什么需要..." />
    <meta name="keywords" content="大数据" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://dupl.github.io/gridea">
  <img class="avatar" src="https://dupl.github.io/gridea/images/avatar.png?v=1744703986223" alt="">
  </a>
  <h1 class="site-title">
    Gridea
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="https://dupl.github.io/gridea" class="menu">
          首页
        </a>
      
    
      
        <a href="https://dupl.github.io/gridea/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="https://dupl.github.io/gridea/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="https://dupl.github.io/gridea/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              【工业与大数据】大数据基础
            </h2>
            <div class="post-info">
              <span>
                2020-01-23
              </span>
              <span>
                10 min read
              </span>
              
                <a href="https://dupl.github.io/gridea/tag/3SWhzU0Q7AM/" class="post-tag">
                  # 大数据
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://dupl.github.io/gridea/post-images/da-shu-ju-de-ji-chu-jia-gou-yun-ji-suan.png" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <p>大数据这个词已经火热了很多年，似乎处处都存在着大数据的噱头，让我们回归本质，探讨一下大数据是什么？<br>
本文介绍了大数据技术细节以及相关背景的的一些概念。本文并未对大数据的相关知识进行总结，所以本文仅作为参考，无需详细阅读。</p>
<!-- more -->
<h2 id="背景-为什么需要大数据">背景 为什么需要大数据？</h2>
<ul>
<li>我们比以往产生<strong>更多</strong>且<strong>更多样性</strong>的数据</li>
<li>我们比以往<strong>更快的</strong>产生数据</li>
<li>这些数据具有其价值性</li>
</ul>
<p>针对以上三个基本原因，我们必须通过处理这些数据来提取其中的价值。</p>
<p>然而处理这些大量的数据面临两个问题：</p>
<ul>
<li>大规模数据的存储</li>
<li>大规模数据的分析</li>
</ul>
<p>这里我们举一个<strong>例子</strong>：早期的网络环境就如同一条小河，依河而居的人们世代通过抓鱼维生。这个时期鱼的数量有限、种类单一。人们只需要把鱼抓起来放到冰箱，想吃的时候直接拿出来烤就可以了。</p>
<figure data-type="image" tabindex="1"><img src="https://dupl.github.io/gridea/post-images/1579677299293.PNG" alt="" loading="lazy"></figure>
<p>随着人类抓鱼的速度越来越快，抓鱼水平越来越高。人们抓到的鱼数量越来越大，种类越来越丰富。人们逐渐遇到了两个代表性的问题：</p>
<ul>
<li>冰箱放不下（存储不足）</li>
<li>烹饪不过来（处理效率不足）</li>
</ul>
<p>如何解决这样的问题呢？</p>
<ol>
<li>冰箱放不下：</li>
</ol>
<p>解决冰箱放不下无非两个思路。①换一个大一点的冰箱（<strong>纵向扩展</strong>）②多买几个冰箱（横向扩展）<br>
显然纵向扩展是难以实现的，存10000...条鱼需要多大的冰箱？<br>
横向扩展相对容易实现，鱼多的时候多买一些冰箱，搞一个冷库（<strong>集群</strong>）然后大家一起去存放鱼（<strong>分布式存储</strong>）<br>
然而随着冰箱越来越多（<strong>集群规模扩大</strong>），人们又单独做了一个账本（<strong>元数据</strong>），里面存储了每条鱼存放在冰箱什么位置的信息。</p>
<ol start="2">
<li>烹饪不过来：</li>
</ol>
<p>鱼越来越多，即使所有的鱼都能保存到冰箱中，但是只有一个厨师的话效率实在太低。<br>
不如多找几个厨师，大家一起烤（分布式计算）</p>
<h2 id=""></h2>
<p>所以说，大数据技术本质上用于解决 海量数据提取、存储、处理的一套技术，分布式是其主要实现思路。</p>
<h2 id="重要结论">重要结论</h2>
<p><strong>学术界普遍认为大数据仍处于发展与创新的初始阶段</strong>。大量数据的存储并不是大数据技术的主要问题甚至不是重要问题，非结构化的数据的快速处理与分析利用才是大数据要解决的最主要问题。</p>
<p><strong>大数据是相对的</strong>，大数据的概念也是不断变化的。（三十年前100M也是大数据）大数据是指用现有技术手段和软件难以快速处理的数据。今天的大数据主要强调数据的非结构性与实时处理的要求。</p>
<p><strong>人是大数据中重要的环节，数据可视化是实现人的作用的主要工具</strong> 大数据强调人通过数据可视化对大数据运算结果的再次分析与知识提炼，以便进行进一步的数据挖掘。</p>
<p>** 大数据的四个特点：**</p>
<ul>
<li>Volume 数据量大</li>
<li>Velocity 速度快</li>
<li>Variety 种类多样</li>
<li>Value 价值密度低</li>
</ul>
<h1 id="一-云计算">一、云计算</h1>
<h2 id="大数据对于系统架构的需求">大数据对于系统架构的需求</h2>
<p>为了对应大数据的几个基本特点：Volume(数据量大) Velocity(产生速度快) Variety(种类多)  Value(价值密度低)。因为以上几个特点，大数据对于数据架构的需求如下：</p>
<ul>
<li>显示的需求
<ul>
<li>海量计算和存储  ➡️  数据量大</li>
<li>快速计算  ➡️  产生速度快</li>
</ul>
</li>
<li>隐式的需求
<ul>
<li>数据的快速传输  ➡️  产生速度快</li>
<li>灵活性  ➡️  种类多</li>
<li>低成本  ➡️  价值密度低</li>
</ul>
</li>
</ul>
<h2 id="大数据的核心设计理念">大数据的核心设计理念</h2>
<ul>
<li>
<p>并行化</p>
<ul>
<li>并行请求</li>
<li>并行进程</li>
<li>并行指令</li>
<li>并行数据</li>
<li>硬件描述</li>
</ul>
</li>
<li>
<p>规模经济  例子：WSC（仓库规模的计算机） 用网络链接起来的计算和存储设备。实用相对同质的硬件和系统软件平台、共享相同的系统管理、运行相对小数目的超大型程序、通用的资源管理架构增强了灵活性。</p>
<ul>
<li>主要部件
<ul>
<li>供电、制冷、建筑、网络、安全</li>
<li>存储、计算</li>
</ul>
</li>
<li>优势
<ul>
<li>规模经济</li>
<li>提高使用率</li>
</ul>
</li>
<li>挑战
<ul>
<li>能耗PUE = Total Energy/Computer Energy</li>
<li>运维</li>
</ul>
</li>
</ul>
</li>
<li>
<p>虚拟化（抽象） 解决多租户、多应用使用的问题</p>
<blockquote>
<p>计算机科学中的所有问题，都可以通过增加一个层次的间接(indirectiron)来解决，当然除了间接层次过多的问题 —— David Wheeler</p>
</blockquote>
</li>
</ul>
<p>虚拟化的结果 —— 每个用户认为自己有一套自己的架构，而实际所有人共享相同的硬件资源。</p>
<figure data-type="image" tabindex="2"><img src="https://dupl.github.io/gridea/post-images/1579969064114.png" alt="" loading="lazy"></figure>
<h1 id="二-虚拟化技术">二、虚拟化技术</h1>
<h3 id="为什么要虚拟化">为什么要虚拟化？</h3>
<p>传统的虚拟化的目的主要是为了分区与抽象</p>
<ul>
<li>分区 Partitioning
<ul>
<li>分享：打破一个大资源</li>
<li>服务器</li>
</ul>
</li>
<li>抽象 Abstraction
<ul>
<li>用一个指令集仿真另一个指令集（简而言之就是一种操作系统使用另外一种系统）</li>
</ul>
</li>
</ul>
<p>在云计算时代，虚拟化是为了资源池，安全，便于管理</p>
<ul>
<li>资源池
<ul>
<li>聚合：将多个资源结合起来</li>
<li>合一：利于存储</li>
<li>动态：快速分配（虚拟机）</li>
</ul>
</li>
<li>隔离：保护消费者隔离其他租客
<ul>
<li>例如虚拟专用网（VPN）</li>
</ul>
</li>
<li>便于管理
<ul>
<li>测试</li>
<li>机动性</li>
</ul>
</li>
</ul>
<h3 id="数据中心虚拟化的三个重要内容">数据中心虚拟化的三个重要内容</h3>
<ul>
<li>计算虚拟化
<ul>
<li>主操作系统：运行在真实机器上</li>
<li>客户操作系统：运行在主操作系统之上</li>
<li>Hypervisor：支持运行在多个虚拟机上的软件
<ul>
<li>类型1:运行在真实机器上，例如 Xen、VMWARE、ESXi</li>
<li>类型2:运行在主操作系统，例如 MS Virtual PC</li>
<li>类型0:1和2兼有，例如 Linux KVM</li>
</ul>
</li>
</ul>
</li>
<li>存储虚拟化</li>
<li>网络虚拟化</li>
</ul>
<h3 id="服务器虚拟化考虑的三个问题">服务器虚拟化考虑的三个问题</h3>
<ul>
<li>指令集的翻译 二进制翻译
<ul>
<li>如何快速执行</li>
<li>如何执行需要更高权限的指令</li>
</ul>
</li>
<li>I/O设备的仿真
<ul>
<li>如何让虚拟机操作系统访问不支持的硬件</li>
<li>如何保护I/O性能</li>
</ul>
</li>
<li>保护处理器的数据结构 <strong>影子</strong>处理器</li>
</ul>
<h3 id="虚拟化的核心问题内存的保护管理">虚拟化的核心问题：内存的保护管理</h3>
<p><img src="https://dupl.github.io/gridea/post-images/1580566550776.png" alt="" loading="lazy"><br>
计算机的内存映射是由MMU进行管理，当计算机虚拟化后运行在计算机上的多个系统对于MMU的控制方式是内存保护管理的重要问题。目前的解决方式：</p>
<ul>
<li>半虚拟化：修改虚拟机操作系统，能不做操作就不要作</li>
<li>影子页表：
<ul>
<li>拒绝客户操作系统对实际页表条目的任何访问</li>
<li>捕获访问请求，在软件中仿真</li>
</ul>
</li>
<li>硬件支持的虚拟化：
<ul>
<li>二级地址转表（SLAT）
<ul>
<li>AMD AMD-V RVI</li>
<li>Intel VT-x EPT</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>MMU是Memory Management Unit的缩写，中文名是内存管理单元，有时称作分页内存管理单元（英语：paged memory management unit，缩写为PMMU）。它是一种负责处理中央处理器（CPU）的内存访问请求的计算机硬件。它的功能包括虚拟地址到物理地址的转换（即虚拟内存管理）、内存保护、中央处理器高速缓存的控制。</p>
</blockquote>
<h3 id="网络虚拟化">网络虚拟化</h3>
<h4 id="网络虚拟化的用途">网络虚拟化的用途</h4>
<figure data-type="image" tabindex="3"><img src="https://dupl.github.io/gridea/post-images/1580567311758.png" alt="" loading="lazy"></figure>
<h4 id="网络虚拟化的举例-vlan">网络虚拟化的举例 ： VLAN</h4>
<p>最简单的目标：提供单一的二层网络</p>
<ul>
<li>端口分数不同的VLAN</li>
<li>多个VLAN共享一个端口
<ul>
<li>Trunk模式</li>
<li>VLAN标签（12bits）：特殊的包头</li>
<li>最多支持4096 VLAN</li>
</ul>
</li>
<li>VLAN的优劣与解决方案
<ul>
<li>优势：标准，支持广泛，硬件成本低</li>
<li>劣势：只能支持4096个VLAN</li>
<li>新的标准：VxLAN
<ul>
<li>通过三层隧道实现</li>
<li>广播 -&gt; 组播</li>
<li>Virtual Tunnel End Ppoints（VTEPs）负责打包和接包</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="现代网络虚拟化技术软件定义网络">现代网络虚拟化技术：软件定义网络</h4>
<ul>
<li>传统网络
<ul>
<li>控制面与数据面集成在同一个设备中</li>
<li>不同网络设备之间通过协议决定如何转发</li>
</ul>
</li>
<li>软件定义网络
<ul>
<li>控制面集中管理，放在服务器中</li>
<li>举例：OpenFlow协议，每一层交换机通过Controller确定数据流向<br>
<img src="https://dupl.github.io/gridea/post-images/1580614390079.png" alt="" loading="lazy"></li>
<li>举例：Portland —— 大规模的虚拟二层网络的实现
<ul>
<li>大型2层网络的挑战
<ul>
<li>地址解析（ARP）：广播</li>
<li>路由：广播</li>
<li>转发：交换机要记住大量状态</li>
<li>根源：MAC地址不连续</li>
</ul>
</li>
<li>Portland实现
<ul>
<li>与位置相关的虚拟地址</li>
<li>通过SDN的地址解析
<ul>
<li>网络截获所有ARP广播</li>
<li>把无序的MAC地址改成与物理位置相关的地址</li>
<li>转发数据包</li>
<li>发给服务器之前，改回原来的MAC地址</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="存储虚拟化">存储虚拟化</h4>
<ul>
<li>存储的意义
<ul>
<li>独立于数据位置
<ul>
<li>扩展性强，容量大</li>
<li>易于管理（磁盘可集中存储）</li>
<li>提升磁盘使用率</li>
</ul>
</li>
<li>独立与物理存储技术
<ul>
<li>易于升级</li>
<li>可用性的优化（多路径访问、冗余）</li>
<li>易于维护（在线的后台备份、恢复）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>存储虚拟化的三类接口
<ul>
<li>块接口
<ul>
<li>本例块存储</li>
<li>远程块存储接口</li>
</ul>
</li>
<li>文件接口
<ul>
<li>文件系统</li>
<li>网络文件系统（NFS，CIFS，HDFS）</li>
<li>VFS</li>
</ul>
</li>
<li>对象存储接口
<ul>
<li>亚马逊S3（基于http协议的REST接口）</li>
<li>OpenStack Swift</li>
</ul>
</li>
</ul>
</li>
<li>存储虚拟化的实现方式
<ul>
<li>SAN 存储区域网络
<ul>
<li>Storage Area Network</li>
<li>存储服务器通过专用网络链接，例如光纤通道（FC）</li>
</ul>
</li>
<li>NAS 网络附接存储
<ul>
<li>Network attached storage（NAS）</li>
<li>存储服务器通过通用网络来访问，例如以太网</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="总结">总结</h3>
<ul>
<li>优势
<ul>
<li>统一、抽象的接口隐藏了复杂的物理硬件</li>
<li>灵活，可以软件定义</li>
<li>易于管理，更容易保证安全</li>
</ul>
</li>
<li>问题
<ul>
<li>虚拟化有一定的资源开销</li>
<li>通常没有实现性能的隔离</li>
<li>过多层的抽象：如何调试 ？</li>
</ul>
</li>
<li>发展趋势：软件定义数据中心？
<ul>
<li>网络功能虚拟化
<ul>
<li>防火墙、入侵检测系统虚拟化</li>
</ul>
</li>
<li>资源的管理和调度</li>
<li>其他资源的虚拟化：空调？供电？建筑？</li>
<li>目标：性能+灵活性+管理</li>
</ul>
</li>
</ul>
<h1 id="三-典型的云计算系统">三、典型的云计算系统</h1>
<h3 id="一个虚拟机的生命周期">一个虚拟机的生命周期</h3>
<figure data-type="image" tabindex="4"><img src="https://dupl.github.io/gridea/post-images/1580630632121.png" alt="" loading="lazy"></figure>
<ol>
<li>用户通过界面或命令行向API发送 ‘create instance’</li>
<li>API节点记录虚拟机信息，发送调度请求给调度器</li>
<li>调度器找到可用的计算节点，向计算节点发送‘vm provision’请求</li>
<li>计算节点通过虚拟机hypervisor启动虚拟机</li>
<li>Hypervisor去<strong>镜像存储服务</strong>获取虚拟机磁盘镜像</li>
<li>计算节点向网络节点发信息，请求给新创虚拟机分配网络资源</li>
<li>网络节点通过配置虚拟交换机配置网桥、VLAN等，实现虚拟网络，并在数据库中记录网络信息</li>
<li>计算节点向虚拟存储服务要求新建虚拟磁盘卷，并通过iSCS协议挂载</li>
<li>用户通过界面查询虚拟机创建的结果</li>
</ol>
<blockquote>
<p>以上操作是异步</p>
</blockquote>
<h3 id="什么是一个好的云计算系统">什么是一个好的云计算系统</h3>
<ul>
<li>让用户彻底忘记底层的硬件（通过好的虚拟化和抽象，让用户忘记复杂的硬件与运算逻辑）</li>
</ul>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E8%83%8C%E6%99%AF-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%A4%A7%E6%95%B0%E6%8D%AE">背景 为什么需要大数据？</a></li>
<li></li>
<li><a href="#%E9%87%8D%E8%A6%81%E7%BB%93%E8%AE%BA">重要结论</a></li>
</ul>
</li>
<li><a href="#%E4%B8%80-%E4%BA%91%E8%AE%A1%E7%AE%97">一、云计算</a>
<ul>
<li><a href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AF%B9%E4%BA%8E%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E7%9A%84%E9%9C%80%E6%B1%82">大数据对于系统架构的需求</a></li>
<li><a href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9A%84%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5">大数据的核心设计理念</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF">二、虚拟化技术</a><br>
*
<ul>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%99%9A%E6%8B%9F%E5%8C%96">为什么要虚拟化？</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E4%B8%89%E4%B8%AA%E9%87%8D%E8%A6%81%E5%86%85%E5%AE%B9">数据中心虚拟化的三个重要内容</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E8%80%83%E8%99%91%E7%9A%84%E4%B8%89%E4%B8%AA%E9%97%AE%E9%A2%98">服务器虚拟化考虑的三个问题</a></li>
<li><a href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E6%A0%B8%E5%BF%83%E9%97%AE%E9%A2%98%E5%86%85%E5%AD%98%E7%9A%84%E4%BF%9D%E6%8A%A4%E7%AE%A1%E7%90%86">虚拟化的核心问题：内存的保护管理</a></li>
<li><a href="#%E7%BD%91%E7%BB%9C%E8%99%9A%E6%8B%9F%E5%8C%96">网络虚拟化</a>
<ul>
<li><a href="#%E7%BD%91%E7%BB%9C%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E7%94%A8%E9%80%94">网络虚拟化的用途</a></li>
<li><a href="#%E7%BD%91%E7%BB%9C%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E4%B8%BE%E4%BE%8B-vlan">网络虚拟化的举例 ： VLAN</a></li>
<li><a href="#%E7%8E%B0%E4%BB%A3%E7%BD%91%E7%BB%9C%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C">现代网络虚拟化技术：软件定义网络</a></li>
<li><a href="#%E5%AD%98%E5%82%A8%E8%99%9A%E6%8B%9F%E5%8C%96">存储虚拟化</a></li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89-%E5%85%B8%E5%9E%8B%E7%9A%84%E4%BA%91%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F">三、典型的云计算系统</a><br>
*
<ul>
<li><a href="#%E4%B8%80%E4%B8%AA%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">一个虚拟机的生命周期</a></li>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%80%E4%B8%AA%E5%A5%BD%E7%9A%84%E4%BA%91%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F">什么是一个好的云计算系统</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://dupl.github.io/gridea/post/python-shi-yong-shou-ce-03-ci-yun/">
              <h3 class="post-title">
                【编程只是工具】Python实用手册03 词云
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '9b1b3d5e02fd883c8d79',
    clientSecret: '7cd8d96a9db672953daac4c7219bb6d618cdd6a8',
    repo: 'gridea',
    owner: 'dupl',
    admin: ['dupl'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://dupl.github.io/gridea/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
